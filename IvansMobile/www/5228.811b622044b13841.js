"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5228],{5228:(A,g,c)=>{c.r(g),c.d(g,{ProductosPageModule:()=>T});var l=c(6814),p=c(95),i=c(7852),s=c(7168),d=c(5861),t=c(6242),h=c(6506),_=c(6389);function f(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col",19)(2,"ion-button",5),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(3);return t.KtG(n.irIni())}),t._uU(3,"Comprar"),t.qZA()()()}}function m(e,a){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,f,4,0,"ion-row",18),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0===o.permiso)}}function b(e,a){1&e&&(t.TgZ(0,"ion-row")(1,"ion-col",19)(2,"h2",17),t._uU(3,"Sin stock"),t.qZA()()())}function v(e,a){if(1&e&&(t.TgZ(0,"div"),t.YNc(1,b,4,0,"ion-row",18),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",0===o.permiso)}}function P(e,a){if(1&e){const o=t.EpF();t.TgZ(0,"ion-row")(1,"ion-col",19)(2,"ion-button",5),t.NdJ("click",function(){t.CHM(o);const n=t.oxw(2);return t.KtG(n.comprar2())}),t._uU(3,"Comprar"),t.qZA()()()}}function x(e,a){if(1&e&&(t.TgZ(0,"ion-grid",11)(1,"ion-row")(2,"ion-col")(3,"h1",12),t._uU(4),t.qZA()()(),t.TgZ(5,"ion-row")(6,"ion-col")(7,"div",13),t._UZ(8,"ion-img",14),t.qZA()()(),t.TgZ(9,"ion-row")(10,"ion-col",15)(11,"p",16),t._uU(12),t.qZA()()(),t.TgZ(13,"ion-row")(14,"ion-col")(15,"h2",17),t._uU(16),t.qZA()(),t.TgZ(17,"ion-col")(18,"h2",17),t._uU(19),t.ALo(20,"currency"),t.qZA()(),t.TgZ(21,"ion-col")(22,"h2",17),t._uU(23),t.qZA()()(),t.YNc(24,m,2,1,"div",18)(25,v,2,1,"div",18)(26,P,4,0,"ion-row",18),t.qZA()),2&e){const o=t.oxw();t.xp6(4),t.Oqu(o.producto.nombreprod),t.xp6(4),t.Q6J("src",o.producto.foto),t.xp6(4),t.Oqu(o.producto.descripcion),t.xp6(4),t.hij("Stock: ",o.producto.stock,""),t.xp6(3),t.Oqu(t.gM2(20,9,o.producto.precio,"$",!0,"4.0-0")),t.xp6(4),t.Oqu(o.producto.unidadmedida),t.xp6(1),t.Q6J("ngIf",o.producto.stock>0),t.xp6(1),t.Q6J("ngIf",o.producto.stock<=0),t.xp6(1),t.Q6J("ngIf",1===o.permiso)}}const Z=[{path:"",component:(()=>{class e{constructor(o,r,n,u,w){this.menuCtrl=o,this.router=r,this.activeRouter=n,this.bd=u,this.permisos=w,this.hayProd=!0,this.codprod=0,this.producto=[{codprod:"",nombreprod:"",descripcion:"",precio:"",stock:"",foto:"",unidadmedida:"",categoriap:""}],this.permisoStorage=0,this.permiso=0,this.idUser=0,this.venta=[{idventa:"",fechaventa:"",estado:"",fechaentrega:"",total:"",carrito:"",usuariov:""}],this.fechaActual=new Date,this.diasSumar=999,this.fechaEntrega=new Date(this.fechaActual),this.detalle=[{iddetalle:"",cantidad:"",subtotal:"",ventad:"",productod:""}],this.detalles=[{iddetalle:"",cantidad:"",subtotal:"",ventad:"",productod:"",nombreprod:"",precio:"",stock:"",foto:""}],this.activeRouter.queryParams.subscribe(k=>{this.router.getCurrentNavigation()?.extras.state&&(this.codprod=this.router.getCurrentNavigation()?.extras?.state?.prodEnviar)})}abrirSuperior(){this.menuCtrl.enable(!0,"superior"),this.menuCtrl.open("superior")}abrirCategorias(){this.menuCtrl.enable(!0,"categorias"),this.menuCtrl.open("categorias")}irHome(){this.router.navigate([""])}irIni(){this.router.navigate(["ini-sesion"])}redireccion(){var o=this;return(0,d.Z)(function*(){o.bd.buscarDetallesVenta(o.venta.idventa).subscribe(r=>{o.detalles=r,o.router.navigate(["home-cli"])})})()}comprar2(){var o=this;return(0,d.Z)(function*(){yield o.buscarCarrito(),o.redireccion()})()}buscarCarrito(){var o=this;return(0,d.Z)(function*(){try{const r=yield o.bd.buscarVentaCarrito2(o.idUser,"Activo");if(r.length>0)o.venta=r[0],yield o.buscarDetalle();else{o.fechaEntrega.setDate(o.fechaActual.getDate()+o.diasSumar);const n=yield o.bd.agregarVenta(o.fechaActual,"Activo",o.fechaEntrega,o.producto.precio,"C",o.idUser);o.bd.agregarDetalle(1,o.producto.precio,n,o.producto.codprod)}}catch(r){console.error("Error al buscar el carrito",r)}})()}buscarDetalle(){var o=this;return(0,d.Z)(function*(){try{const r=yield o.bd.buscarDetalleProd2(o.producto.codprod,o.venta.idventa);r.length>0?(o.detalle=r[0],o.bd.modificarDetalle(o.detalle.iddetalle,o.detalle.subtotal+o.producto.precio,o.detalle.cantidad+1,o.venta.idventa),o.bd.modificarTotal(o.venta.idventa,o.venta.total+o.producto.precio)):(o.bd.agregarDetalle(1,o.producto.precio,o.venta.idventa,o.producto.codprod),o.bd.modificarTotal(o.venta.idventa,o.venta.total+o.producto.precio))}catch(r){console.error("Error al buscar el detalle",r)}})()}ngOnInit(){this.idUser=localStorage.getItem("usuario"),this.bd.dbState().subscribe(o=>{o&&(this.bd.buscarProducto(this.codprod),this.bd.fetchProducto().subscribe(r=>{r.length>0?(this.producto=r[0],this.hayProd=!0):this.hayProd=!1}))}),this.permisos.Rol.subscribe(o=>{this.permiso=o})}static#t=this.\u0275fac=function(r){return new(r||e)(t.Y36(i._q),t.Y36(s.F0),t.Y36(s.gz),t.Y36(h.N),t.Y36(_.X))};static#o=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-productos"]],decls:13,vars:3,consts:[[1,"cabecera",3,"translucent"],[1,"logo-contenedor"],["src","/assets/logo.png","alt","No hay logo"],["color","paleta",1,"toolbar-c"],["slot","end",1,"boton-guesa"],[3,"click"],[1,"titulo",3,"click"],[1,"categorias"],["fill","clear",3,"click"],[1,"cuerpo",3,"fullscreen"],["class","contenido",4,"ngIf"],[1,"contenido"],[1,"nombre-pag"],[1,"contenedor-imagen"],["alt","No hay imagen :c",3,"src"],[1,"contenedor-desc"],[1,"desc"],[1,"precio"],[4,"ngIf"],[1,"contenedor-boton"]],template:function(r,n){1&r&&(t.TgZ(0,"ion-header",0)(1,"div",1),t._UZ(2,"ion-img",2),t.qZA(),t.TgZ(3,"ion-toolbar",3)(4,"ion-buttons",4)(5,"ion-menu-button",5),t.NdJ("click",function(){return n.abrirSuperior()}),t.qZA()(),t.TgZ(6,"ion-title",6),t.NdJ("click",function(){return n.irHome()}),t._uU(7," Ivan's "),t.qZA()(),t.TgZ(8,"div",7)(9,"ion-button",8),t.NdJ("click",function(){return n.abrirCategorias()}),t._uU(10,"Categorias"),t.qZA()()(),t.TgZ(11,"ion-content",9),t.YNc(12,x,27,14,"ion-grid",10),t.qZA()),2&r&&(t.Q6J("translucent",!0),t.xp6(11),t.Q6J("fullscreen",!0),t.xp6(1),t.Q6J("ngIf",!0===n.hayProd))},dependencies:[l.O5,i.YG,i.Sm,i.wI,i.W2,i.jY,i.Gu,i.Xz,i.fG,i.Nd,i.wd,i.sr,l.H9],styles:[".cuerpo[_ngcontent-%COMP%]{--background: #fff}.nombre-pag[_ngcontent-%COMP%]{text-align:center;text-decoration:underline;color:#000;font-size:35px;font-weight:700}.contenedor-imagen[_ngcontent-%COMP%]{height:200px;width:200px;margin:auto;border:1px solid #000}.contenedor-imagen[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%}.desc[_ngcontent-%COMP%]{color:#000;font-size:20px;text-align:center}.precio[_ngcontent-%COMP%]{font-size:25px;color:#000;font-weight:700;text-align:center}.contenedor-boton[_ngcontent-%COMP%]{height:70px;width:90px;display:flex;align-items:center}.contenedor-boton[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{width:100%;height:100%;--background: #ff0;--color: #000;font-weight:700;font-size:25px;--border-radius: 100px}"]})}return e})()}];let C=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#o=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[s.Bz.forChild(Z),s.Bz]})}return e})(),T=(()=>{class e{static#t=this.\u0275fac=function(r){return new(r||e)};static#o=this.\u0275mod=t.oAB({type:e});static#e=this.\u0275inj=t.cJS({imports:[l.ez,p.u5,i.Pc,C]})}return e})()}}]);
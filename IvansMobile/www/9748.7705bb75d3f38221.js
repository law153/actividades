"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[9748],{9748:(A,p,l)=>{l.r(p),l.d(p,{EditarPerfilPageModule:()=>j});var m=l(6814),d=l(95),a=l(7852),h=l(7168),u=l(5861),e=l(6242),f=l(6506),b=l(6370),_=l(8513),C=l(6389);const P=["ionInputEl"];function Z(s,T){if(1&s&&(e.TgZ(0,"ion-select-option",31),e._uU(1),e.qZA()),2&s){const o=T.$implicit;e.Q6J("value",o),e.xp6(1),e.Oqu(o.nombrepregunta)}}const M=[{path:"",component:(()=>{class s{constructor(o,i,t,n,r,c){this.router=o,this.menuCtrl=i,this.bd=t,this.camara=n,this.sesion=r,this.permisos=c,this.msjRut="",this.msjNombre="",this.msjApellido="",this.msjFono="",this.msjDirec="",this.msjCorreo="",this.msjPreg="",this.msjResp="",this.msj="",this.rut="",this.dvrut="",this.nombre="",this.apellido="",this.fono="",this.direc="",this.correo="",this.clave="",this.claveRep="",this.pregunta="",this.respuesta="",this.flag=!0,this.correoUser="",this.correoStorage="",this.rolStorage="",this.usuario={idusuario:"",rut:"",dvrut:"",nombre:"",apellido:"",telefono:"",correo:"",clave:"",direccion:"",fotousuario:"",respuesta:"",rolu:"",preguntau:""},this.pregId=0,this.preguntas=[{idpregunta:"",nombrepregunta:""}]}irHomeCli(){this.router.navigate([""])}abrirSuperior(){this.menuCtrl.enable(!0,"superior"),this.menuCtrl.open("superior")}abrirCategorias(){this.menuCtrl.enable(!0,"categorias"),this.menuCtrl.open("categorias")}compareFn(o,i){return o&&i?o.idpregunta===i.idpregunta:o===i}envioValido(){var o=this;return(0,u.Z)(function*(){o.flag=!0,yield o.rutValido(),o.nombreValido(),o.apellidoValido(),yield o.correoValido(),o.respuestValida(),o.direcValida(),o.preguntaValida(),o.fonoValido(),!0===o.flag&&(o.pregId=parseInt(o.pregunta),o.editarPerfil(),o.sesion.setCorreoSesion(o.correo),localStorage.setItem("correo",o.correo))})()}rutValido(){var o=this;return(0,u.Z)(function*(){if(o.msjRut="",0===o.rut.length||0===o.dvrut.length)o.flag=!1,o.msjRut+="Debe llenar estos campos";else{!1===o.SoloNumeros(o.rut)&&(o.flag=!1,o.msjRut+="El rut se compone solo de n\xfameros \n"),!1===o.SoloNumerosOk(o.dvrut)&&(o.flag=!1,o.msjRut+="El digito verificador solo se compone de n\xfameros o k\n"),!1===o.validarRut(o.rut,o.dvrut)&&(o.flag=!1,o.msjRut+="Rut invalido\n");try{(yield o.bd.buscarPorRutMenosTu(o.rut,o.usuario.idusuario)).length>0&&(o.flag=!1,o.msjRut="RUT ya ocupado en el sistema\n")}catch(i){console.error("Error al buscar usuario por RUT:",i)}}})()}nombreValido(){this.msjNombre="",0===this.nombre.length?(this.flag=!1,this.msjNombre="Debe llenar este campo"):(!1===this.primerCaracterEsMayus(this.nombre)&&(this.flag=!1,this.msjNombre+="La primera letra de su nombre debe ser may\xfascula\n"),!0===this.contieneNumero(this.nombre)&&(this.flag=!1,this.msjNombre+="Un nombre no debe contener n\xfameros\n"),this.contieneCaracterEspecial(this.nombre)&&(this.flag=!1,this.msjNombre+="Un nombre no debe contener car\xe1cteres especiales\n"))}apellidoValido(){0===this.apellido.length?(this.flag=!1,this.msjApellido="Debe llenar este campo"):!1===this.primerCaracterEsMayus(this.apellido)?(this.flag=!1,this.msjApellido+="La primera letra de su apellido debe ser may\xfascula\n"):!0===this.contieneNumero(this.apellido)?(this.flag=!1,this.msjApellido+="Un apellido no debe contener n\xfameros\n"):1==this.tieneCaracteresApellido(this.apellido)&&(this.flag=!1,this.msjApellido+="Un apellido no debe contener car\xe1cteres especiales\n")}onInput(o){const t=o.target.value.replace(/[^0-9]+/g,"");this.ionInputEl.value=this.fono=t}fonoValido(){this.msjFono="",0===this.fono.length?(this.flag=!1,this.msjFono="Debe llenar este campo"):this.fono.length<8&&(this.flag=!1,this.msjFono+="El tel\xe9fono debe ser de 8 n\xfameros\n")}correoValido(){var o=this;return(0,u.Z)(function*(){if(o.msjCorreo="",0===o.correo.length)o.msjCorreo="Debe llenar este campo";else{!1===o.esCorreoValido(o.correo)&&(o.flag=!1,o.msjCorreo+="Su correo no es valido\n");try{(yield o.bd.buscarPorCorreoMenosTu(o.correo,o.usuario.idusuario)).length>0&&(o.flag=!1,o.msjCorreo="Correo ya ocupado en el sistema\n")}catch(i){console.error("Error al buscar usuario por CORREO:",i)}}})()}direcValida(){this.msjDirec="",0===this.direc.length?(this.flag=!1,this.msjDirec="Debe llenar este campo"):(!1===this.primerCaracterEsMayus(this.direc)&&(this.flag=!1,this.msjDirec+="Su direcci\xf3n debe comenzar con una may\xfascula\n"),!1===this.contieneNumero(this.direc)&&(this.flag=!1,this.msjDirec+="Su direcci\xf3n debe contener un n\xfamero\n"))}capturarImagen(){var o=this;return(0,u.Z)(function*(){o.foto=yield o.camara.takePicture()})()}preguntaValida(){this.msjPreg="",this.pregunta=this.preguntaseleccionada.nombrepregunta,0===this.pregunta.length&&(this.flag=!1,this.msjPreg="No ha seleccionado ninguna pregunta")}respuestValida(){this.msjResp="",0===this.respuesta.length&&(this.flag=!1,this.msjResp="No puede dejar la respuesta vac\xeda")}editarPerfil(){this.bd.modificarUsuario(this.usuario.idusuario,this.nombre,this.apellido,parseInt(this.rut),this.dvrut,this.fono,this.correo,this.direc,this.foto,this.respuesta,this.preguntaseleccionada.idpregunta),this.bd.presentAlert("Usuario editado con exito"),this.router.navigate([""])}borrarCuenta(){var o=this;return(0,u.Z)(function*(){o.bd.eliminarUsuario(o.usuario.idusuario),yield o.bd.presentAlert("Cuenta borrada"),localStorage.setItem("rol","0"),o.rolStorage=localStorage.getItem("rol"),o.permisos.setUserRole(parseInt(o.rolStorage)),localStorage.setItem("correo",""),o.correoStorage=localStorage.getItem("correo"),o.sesion.setCorreoSesion(o.correoStorage),o.router.navigate([""])})()}esCorreoValido(o){return/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(o)}primerCaracterEsMayus(o){const i=o.charAt(0);return/[A-Z]/.test(i)}tieneCaracteresApellido(o){return/[!@#$%^&*()_+{}\[\]:;<>,.?~/-]/.test(o)}SoloNumeros(o){return/^[0-9]+$/.test(o)}SoloNumerosOk(o){return/^[0-9Kk]+$/.test(o)}validarRut(o,i){const t=o.replace(/\D/g,"");return 8===t.length&&this.calcularDigitoVerificador(t)===i.toUpperCase()}calcularDigitoVerificador(o){const i=[2,3,4,5,6,7,2,3];let t=0;for(let c=o.length-1,g=0;c>=0;c--,g++)t+=parseInt(o[c])*i[g],7===g&&(g=0);const r=11-t%11;return 10===r?"K":11===r?"0":r.toString()}contieneNumero(o){return/\d/.test(o)}contieneCaracterEspecial(o){return/[!@#$%^&*()_+{}\[\]:;<>,.?~\\/-]/.test(o)}ngOnInit(){this.correoUser=localStorage.getItem("correo"),this.bd.dbState().subscribe(o=>{o&&(this.bd.fetchPregunta().subscribe(i=>{this.preguntas=i}),this.bd.buscarPorCorreo(this.correoUser).subscribe(i=>{this.usuario=i[0],this.usuario&&(this.nombre=this.usuario.nombre,this.apellido=this.usuario.apellido,this.rut=this.usuario.rut+"",this.dvrut=this.usuario.dvrut,this.correo=this.usuario.correo,this.respuesta=this.usuario.respuesta,this.direc=this.usuario.direccion,this.foto=this.usuario.fotousuario,this.fono=this.usuario.telefono,this.pregId=this.usuario.preguntau,this.preguntas&&this.preguntas.length>0&&(this.preguntaseleccionada=this.preguntas.find(t=>t.idpregunta===this.pregId)))}))})}static#e=this.\u0275fac=function(i){return new(i||s)(e.Y36(h.F0),e.Y36(a._q),e.Y36(f.N),e.Y36(b.Y),e.Y36(_.J),e.Y36(C.X))};static#o=this.\u0275cmp=e.Xpm({type:s,selectors:[["app-editar-perfil"]],viewQuery:function(i,t){if(1&i&&e.Gf(P,7),2&i){let n;e.iGM(n=e.CRH())&&(t.ionInputEl=n.first)}},decls:98,vars:22,consts:[[1,"cabecera",3,"translucent"],[1,"logo-contenedor"],["src","/assets/logo.png","alt","No hay logo"],["color","paleta",1,"toolbar-c"],["slot","end",1,"boton-guesa"],[3,"click"],[1,"titulo",3,"click"],[1,"categorias"],["fill","clear",3,"click"],[1,"content-fondo",3,"fullscreen"],[1,"nombre-pag"],[1,"contenedor-imagen"],["alt","No hay imagen :C",3,"src"],[2,"text-align","center","margin","auto"],[1,"boton-subir",2,"text-align","center",3,"click"],["name","cloud-upload"],[1,"contenedor-form"],["labelPlacement","stacked","label","Nombre","type","text","placeholder","Nombre","maxlength","15",3,"ngModel","ngModelChange"],[1,"validacion"],["labelPlacement","stacked","label","Apellido","type","text","placeholder","Apellido","maxlength","15",3,"ngModel","ngModelChange"],["labelPlacement","stacked","label","Rut","type","text","placeholder","Rut","maxlength","8",3,"ngModel","ngModelChange"],["labelPlacement","stacked","label","Dvrut","type","text","placeholder","Dvrut","maxlength","1",3,"ngModel","ngModelChange"],["labelPlacement","stacked","label","Tel\xe9fono","type","text","placeholder","Tel\xe9fono","maxlength","8",3,"ngModel","ngModelChange","ionInput"],["ionInputEl",""],["labelPlacement","stacked","label","Direcci\xf3n","type","text","placeholder","Direcci\xf3n","maxlength","20",3,"ngModel","ngModelChange"],["labelPlacement","stacked","label","Correo","type","email","placeholder","Correo","placeholder","Correo","maxlength","30",3,"ngModel","ngModelChange"],["labelPlacement","stacked","label","Pregunta de Seguridad",3,"ngModel","compareWith","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["labelPlacement","stacked","label","Respuesta","type","text","placeholder","Respuesta","maxlength","30",3,"ngModel","ngModelChange"],[1,"contenedor-botones"],["shape","round",3,"click"],[3,"value"]],template:function(i,t){1&i&&(e.TgZ(0,"ion-header",0)(1,"div",1),e._UZ(2,"ion-img",2),e.qZA(),e.TgZ(3,"ion-toolbar",3)(4,"ion-buttons",4)(5,"ion-menu-button",5),e.NdJ("click",function(){return t.abrirSuperior()}),e.qZA()(),e.TgZ(6,"ion-title",6),e.NdJ("click",function(){return t.irHomeCli()}),e._uU(7," Ivan's "),e.qZA()(),e.TgZ(8,"div",7)(9,"ion-button",8),e.NdJ("click",function(){return t.abrirCategorias()}),e._uU(10,"Categorias"),e.qZA()()(),e.TgZ(11,"ion-content",9)(12,"ion-grid")(13,"div")(14,"ion-row")(15,"ion-col")(16,"h1",10),e._uU(17,"Editar Perfil"),e.qZA()()()(),e.TgZ(18,"ion-row")(19,"ion-col")(20,"div",11),e._UZ(21,"ion-img",12),e.qZA()()(),e.TgZ(22,"ion-row"),e._UZ(23,"ion-col"),e.TgZ(24,"ion-col",13)(25,"ion-button",14),e.NdJ("click",function(){return t.capturarImagen()}),e._UZ(26,"ion-icon",15),e._uU(27,"Subir imagen "),e.qZA()(),e._UZ(28,"ion-col"),e.qZA(),e.TgZ(29,"div",16)(30,"ion-row")(31,"ion-col")(32,"ion-input",17),e.NdJ("ngModelChange",function(r){return t.nombre=r}),e.qZA()()(),e.TgZ(33,"ion-row")(34,"ion-col")(35,"pre",18),e._uU(36),e.qZA()()(),e.TgZ(37,"ion-row")(38,"ion-col")(39,"ion-input",19),e.NdJ("ngModelChange",function(r){return t.apellido=r}),e.qZA()()(),e.TgZ(40,"ion-row")(41,"ion-col")(42,"pre",18),e._uU(43),e.qZA()()(),e.TgZ(44,"ion-row")(45,"ion-col")(46,"ion-input",20),e.NdJ("ngModelChange",function(r){return t.rut=r}),e.qZA()(),e.TgZ(47,"ion-col")(48,"ion-input",21),e.NdJ("ngModelChange",function(r){return t.dvrut=r}),e.qZA()()(),e.TgZ(49,"ion-row")(50,"ion-col")(51,"pre",18),e._uU(52),e.qZA()()(),e.TgZ(53,"ion-row")(54,"ion-col")(55,"ion-input",22,23),e.NdJ("ngModelChange",function(r){return t.fono=r})("ionInput",function(r){return t.onInput(r)}),e.qZA()()(),e.TgZ(57,"ion-row")(58,"ion-col")(59,"pre",18),e._uU(60),e.qZA()()(),e.TgZ(61,"ion-row")(62,"ion-col")(63,"ion-input",24),e.NdJ("ngModelChange",function(r){return t.direc=r}),e.qZA()()(),e.TgZ(64,"ion-row")(65,"ion-col")(66,"pre",18),e._uU(67),e.qZA()()(),e.TgZ(68,"ion-row")(69,"ion-col")(70,"ion-input",25),e.NdJ("ngModelChange",function(r){return t.correo=r}),e.qZA()()(),e.TgZ(71,"ion-row")(72,"ion-col")(73,"pre",18),e._uU(74),e.qZA()()(),e.TgZ(75,"ion-row")(76,"ion-col")(77,"ion-select",26),e.NdJ("ngModelChange",function(r){return t.preguntaseleccionada=r}),e.YNc(78,Z,2,2,"ion-select-option",27),e.qZA()()(),e.TgZ(79,"ion-row")(80,"ion-col")(81,"pre",18),e._uU(82),e.qZA()()(),e.TgZ(83,"ion-row")(84,"ion-col")(85,"ion-input",28),e.NdJ("ngModelChange",function(r){return t.respuesta=r}),e.qZA()()(),e.TgZ(86,"ion-row")(87,"ion-col")(88,"pre",18),e._uU(89),e.qZA()()()(),e.TgZ(90,"div",29)(91,"ion-row")(92,"ion-col")(93,"ion-button",30),e.NdJ("click",function(){return t.borrarCuenta()}),e._uU(94," Eliminar Cuenta "),e.qZA()(),e.TgZ(95,"ion-col")(96,"ion-button",30),e.NdJ("click",function(){return t.envioValido()}),e._uU(97," Guardar "),e.qZA()()()()()()),2&i&&(e.Q6J("translucent",!0),e.xp6(11),e.Q6J("fullscreen",!0),e.xp6(10),e.Q6J("src",t.foto),e.xp6(11),e.Q6J("ngModel",t.nombre),e.xp6(4),e.Oqu(t.msjNombre),e.xp6(3),e.Q6J("ngModel",t.apellido),e.xp6(4),e.Oqu(t.msjApellido),e.xp6(3),e.Q6J("ngModel",t.rut),e.xp6(2),e.Q6J("ngModel",t.dvrut),e.xp6(4),e.Oqu(t.msjRut),e.xp6(3),e.Q6J("ngModel",t.fono),e.xp6(5),e.Oqu(t.msjFono),e.xp6(3),e.Q6J("ngModel",t.direc),e.xp6(4),e.Oqu(t.msjDirec),e.xp6(3),e.Q6J("ngModel",t.correo),e.xp6(4),e.Oqu(t.msjCorreo),e.xp6(3),e.Q6J("ngModel",t.preguntaseleccionada)("compareWith",t.compareFn),e.xp6(1),e.Q6J("ngForOf",t.preguntas),e.xp6(4),e.Oqu(t.msjPreg),e.xp6(3),e.Q6J("ngModel",t.respuesta),e.xp6(4),e.Oqu(t.msjResp))},dependencies:[m.sg,d.JJ,d.nD,d.On,a.YG,a.Sm,a.wI,a.W2,a.jY,a.Gu,a.gu,a.Xz,a.pK,a.fG,a.Nd,a.t9,a.n0,a.wd,a.sr,a.QI,a.j9],styles:[".contenedor-imagen[_ngcontent-%COMP%]{width:100px;height:100px;border:2px solid #000;margin:auto}.contenedor-imagen[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{width:100%;height:100%}.contenedor-form[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{font-size:18px}.contenedor-form[_ngcontent-%COMP%]   ion-select[_ngcontent-%COMP%]{font-size:18px}.contenedor-botones[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{padding-left:10%;padding-right:10%;font-size:15px;--background: #000;color:#fff;text-align:center}"]})}return s})()}];let v=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#o=this.\u0275mod=e.oAB({type:s});static#t=this.\u0275inj=e.cJS({imports:[h.Bz.forChild(M),h.Bz]})}return s})(),j=(()=>{class s{static#e=this.\u0275fac=function(i){return new(i||s)};static#o=this.\u0275mod=e.oAB({type:s});static#t=this.\u0275inj=e.cJS({imports:[m.ez,d.u5,a.Pc,v]})}return s})()}}]);